<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="adc">
<title>Introduction • adc</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../../deps/EB_Garamond-0.4.5/font.css" rel="stylesheet">
<link href="../../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet">
<link href="../../deps/Oswald-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="adc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">adc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web/Introduction.html">Introduction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TxWRI/adc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction</h1>
                        <h4 data-toc-skip class="author">Michael
Schramm</h4>
            
            <h4 data-toc-skip class="date">2023-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TxWRI/adc/blob/HEAD/vignettes/web/Introduction.Rmd" class="external-link"><code>vignettes/web/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basic-functions">Basic Functions<a class="anchor" aria-label="anchor" href="#basic-functions"></a>
</h2>
<p>The adc package provides a handful of functions for developing
flow-based covariates useful in regression-based pollutant load
modeling. The primary package functions include:</p>
<ul>
<li><p><code><a href="../../reference/bf_sep_lh.html">bf_sep_lh()</a></code> - uses the Lyne and Hollick filter to
separate baseflow component from the quickflow component <span class="citation">(Lyne and Hollick 1979)</span>. Baseflow/Total Flow
provides a baseflow index that is an estimate of the contribution of
slow flow to total streamflow. This index can be useful for capturing
relationships of subsurface solutes and streamflow. The function
implements the approach described by <span class="citation">Ladson et
al. (2013)</span>.</p></li>
<li><p><code><a href="../../reference/fa.html">fa()</a></code> - calculates the flow anomaly, or the
difference in flow for the current time period (day, week, month, year,
etc.) from a prior period (days, weeks, months, years, or complete flow
record) <span class="citation">(Vecchia et al. 2009)</span>. Positive
values indicate the current period is wetter than the prior period.
<span class="citation">Zhang and Ball (2017)</span> demonstrate the use
of different time periods to account for long-term, mid-term, and
short-term flow anomalies.</p></li>
<li><p><code><a href="../../reference/rate_of_change.html">rate_of_change()</a></code> - is the estimate of the current
instantaneous rate of change in daily streamflow. This is essentially an
estimate of the difference in streamflow at time <span class="math inline">\(T\)</span> and <span class="math inline">\(T-1\)</span> <span class="citation">(Zhang and
Ball 2017)</span>. Positive values mean streamflow is increasing and
negative values mean streamflow is decreasing. This term can capture
hysteresis effects in dissolved solutes and hydrograph limbs. This
function estimates <span class="math inline">\(\frac{d Q}{d t}\)</span>
on the raw data or it will fit a cubic regression spline between date
and discharge when the argument <code>smooth = TRUE</code> is used and
return the derivative of the fitted function.</p></li>
<li><p><code><a href="../../reference/sdf.html">sdf()</a></code> - the smooth discounted flow is an
exponentially weighted average of streamflow values <span class="citation">(Kuhnert et al. 2012)</span>. This captures the
integrated effect of all past flows with higher weight assigned to more
recent flows than those that occurred long ago.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>All functions are intended to work on vectors of streamflow and
Date/Time data. Each function will return a numeric vector the same
length as the input arguments. An example dataset is provided:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TxWRI/adc" class="external-link">adc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lavaca"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## run the lyne and hollick baseflow seperation filter</span></span>
<span><span class="va">baseflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/bf_sep_lh.html">bf_sep_lh</a></span><span class="op">(</span>discharge <span class="op">=</span> <span class="va">lavaca</span><span class="op">$</span><span class="va">Flow</span>,</span>
<span>                      a <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="co">## calculate the baseflow index</span></span>
<span><span class="va">bfi</span> <span class="op">&lt;-</span> <span class="va">baseflow</span><span class="op">/</span><span class="va">lavaca</span><span class="op">$</span><span class="va">Flow</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bfi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2336661 0.2458989 0.2579990 0.2327504 0.1922516 0.2004877</span></span>
<span></span>
<span><span class="co">## calculate flow anomalies</span></span>
<span></span>
<span><span class="co">#long term flow anomaly described in Zhang &amp; Ball (2017)</span></span>
<span><span class="va">ltfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fa.html">fa</a></span><span class="op">(</span><span class="va">lavaca</span><span class="op">$</span><span class="va">Flow</span>,</span>
<span>           dates <span class="op">=</span> <span class="va">lavaca</span><span class="op">$</span><span class="va">Date</span>,</span>
<span>           T_1 <span class="op">=</span> <span class="st">"1 year"</span>,</span>
<span>           T_2 <span class="op">=</span> <span class="st">"period"</span>,</span>
<span>           clean_up <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           transform <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ltfa</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]         NA -0.7490517 -0.7490517 -0.7490517 -0.7329372 -0.7028938</span></span>
<span></span>
<span><span class="co">## rate of change</span></span>
<span><span class="va">dqdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/rate_of_change.html">rate_of_change</a></span><span class="op">(</span><span class="va">lavaca</span><span class="op">$</span><span class="va">Flow</span>, <span class="va">lavaca</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dqdt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.07163096 -0.01050499 -0.08719290 -0.15843278 -0.22422462 -0.28456842</span></span>
<span></span>
<span><span class="co">## smooth discounted flow</span></span>
<span><span class="va">ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sdf.html">sdf</a></span><span class="op">(</span><span class="va">lavaca</span><span class="op">$</span><span class="va">Flow</span>, delta<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ma</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.5000 7.5000 7.5000 7.5600 7.7320 7.8954</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tidy-workflow">Tidy Workflow<a class="anchor" aria-label="anchor" href="#tidy-workflow"></a>
</h2>
<p>These functions can also be used in a tidy workflow:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create new column variable</span></span>
<span><span class="va">lavaca</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>baseflow <span class="op">=</span> <span class="fu"><a href="../../reference/bf_sep_lh.html">bf_sep_lh</a></span><span class="op">(</span><span class="va">Flow</span>, a <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>         ltfa <span class="op">=</span> <span class="fu"><a href="../../reference/fa.html">fa</a></span><span class="op">(</span><span class="va">Flow</span>, <span class="va">Date</span>, T_1 <span class="op">=</span> <span class="st">"1 year"</span>,</span>
<span>                   T_2 <span class="op">=</span> <span class="st">"period"</span>, clean_up <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   transform <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span>,</span>
<span>         dqdt <span class="op">=</span> <span class="fu"><a href="../../reference/rate_of_change.html">rate_of_change</a></span><span class="op">(</span><span class="va">Flow</span>, <span class="va">Date</span><span class="op">)</span>,</span>
<span>         ma <span class="op">=</span> <span class="fu"><a href="../../reference/sdf.html">sdf</a></span><span class="op">(</span><span class="va">Flow</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2004-01-01"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-12-31"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">df</span></span>
<span></span>
<span></span>
<span><span class="co">##plot</span></span>
<span></span>
<span><span class="co">## we are going to create a function to do this</span></span>
<span><span class="va">plot_columns</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">column</span>, <span class="va">x_axis</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_axis</span>, y <span class="op">=</span> <span class="va">column</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="va">column</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## apply the function to each variable</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Flow"</span>, <span class="st">"baseflow"</span>, <span class="st">"ltfa"</span>, <span class="st">"dqdt"</span>, <span class="st">"ma"</span><span class="op">)</span>,</span>
<span>                <span class="va">plot_columns</span>,</span>
<span>                data <span class="op">=</span> <span class="va">df</span>,</span>
<span>                x_axis <span class="op">=</span> <span class="st">"Date"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## use patchwork to put these all together</span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">plots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">plots</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">plots</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-2-1.png" width="2000"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-kuhnert_quantifying_2012" class="csl-entry">
Kuhnert, P.M., Henderson, B.L., Lewis, S.E., Bainbridge, Z.T.,
Wilkinson, S.N., and Brodie, J.E. 2012. Quantifying total suspended
sediment export from the Burdekin River catchment using the loads
regression estimator tool. Water Resources Research 48 (4). <a href="https://doi.org/10.1029/2011WR011080" class="external-link">https://doi.org/10.1029/2011WR011080</a>.
</div>
<div id="ref-ladson_standard_2013" class="csl-entry">
Ladson, A.R., Brown, R., Neal, B., and Nathan, R. 2013. A standard
approach to baseflow seperation using the Lyne and Hollick filter.
Australasian Journal of Water Resources 17 (1): 25–34.
</div>
<div id="ref-lyne_stochastic_1979" class="csl-entry">
Lyne, V., and Hollick, M. 1979. Stochastic time-variable rainfall runoff
modelling. In, 79:89–93. Barton, Australia.
</div>
<div id="ref-vecchia_trends_2009" class="csl-entry">
Vecchia, A.V., Gilliom, R.J., Sullivan, D.J., Lorenz, D.L., and Martin,
J.D. 2009. Trends in Concentrations and Use of Agricultural Herbicides
for Corn Belt Rivers, 1996−2006. Environmental Science &amp; Technology
43 (24): 9096–9102. <a href="https://doi.org/10.1021/es902122j" class="external-link">https://doi.org/10.1021/es902122j</a>.
</div>
<div id="ref-zhang_improving_2017" class="csl-entry">
Zhang, Q., and Ball, W.P. 2017. Improving riverine constituent
concentration and flux estimation by accounting for antecedent discharge
conditions. Journal of Hydrology 547 (April): 387–402. <a href="https://doi.org/10.1016/j.jhydrol.2016.12.052" class="external-link">https://doi.org/10.1016/j.jhydrol.2016.12.052</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/mps9506" class="external-link">Michael Schramm</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
